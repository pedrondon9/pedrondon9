
//rm -rf .next

//npx prisma generate && npx prisma db push

// para iteraciones npx prisma db push

// yarn prisma generate

// cmd + shift + p en cualquier archivo .ts o tsx seguido de TypeScript: Restart TS Server

// brew services start postgresql
// Stop Service: brew services stop postgresql.
// Restart Service: brew services restart postgresql.
// Connect to Database: psql -U $(whoami) postgres

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}


model User {
  id            Int       @id @default(autoincrement())
  name          String    @db.VarChar(100)
  email         String    @unique @db.VarChar(150)
  passwordHash  String    @db.Text
  emailVerified DateTime? 
  createdAt     DateTime  @default(now()) @db.Timestamp(6)
  
  projects      Project[]
}

model VerificationToken {
  identifier String
  token      String   @unique
  expires    DateTime

  @@unique([identifier, token])
}

model Project {
  id           Int            @id @default(autoincrement())
  title        String         @db.VarChar(200)
  description  String?        
  
  // Relación con las imágenes
  images       ProjectImage[] 
  
  // Relación Muchos a Muchos con Categorías
  categories   Category[]     @relation("ProjectToCategory")
  
  technologies String[]       
  projectLink  String?        
  projectVideo String?        
  githubLink   String?        
  
  userId       Int            
  user         User           @relation(fields: [userId], references: [id], onDelete: Cascade)
  createdAt    DateTime       @default(now()) @db.Date
}

model ProjectImage {
  id        Int     @id @default(autoincrement())
  url       String  
  projectId Int     
  project   Project @relation(fields: [projectId], references: [id], onDelete: Cascade)
}

model Category {
  id       Int       @id @default(autoincrement())
  name     String    @unique 
  projects Project[] @relation("ProjectToCategory")
}

model PasswordResetToken {
  id      String   @id @default(cuid())
  email   String
  token   String   @unique
  expires DateTime

  @@unique([email, token])
}